# Prometheus configuration for Roost
# P21.2.001: Prometheus Metrics Endpoint
# Mount this at /etc/prometheus/prometheus.yml in the Prometheus container.
global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    service: roost
    environment: production

alerting:
  alertmanagers:
    - static_configs:
        - targets:
            - alertmanager:9093

rule_files:
  - /etc/prometheus/alerts/*.yml

scrape_configs:
  - job_name: roost-api
    static_configs:
      - targets:
          - localhost:3001
    metrics_path: /metrics
    scrape_interval: 15s

  - job_name: roost-billing
    static_configs:
      - targets:
          - localhost:8085
    metrics_path: /metrics
    scrape_interval: 15s

  - job_name: roost-owl-api
    static_configs:
      - targets:
          - localhost:8091
    metrics_path: /metrics
    scrape_interval: 15s

  - job_name: roost-ingest
    static_configs:
      - targets:
          - localhost:8086
    metrics_path: /metrics
    scrape_interval: 15s

  - job_name: roost-relay
    static_configs:
      - targets:
          - localhost:8087
    metrics_path: /metrics
    scrape_interval: 15s

  - job_name: roost-sports
    static_configs:
      - targets:
          - localhost:8093
    metrics_path: /metrics
    scrape_interval: 30s

  - job_name: postgres
    static_configs:
      - targets:
          - localhost:9187  # postgres_exporter
    scrape_interval: 30s

  - job_name: node
    static_configs:
      - targets:
          - localhost:9100  # node_exporter
    scrape_interval: 30s
