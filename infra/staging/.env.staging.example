# .env.staging.example — Staging environment configuration for Roost.
# Copy to .env.staging on the staging server (never commit the real file).
# All values here are placeholders — replace before deploying.
#
# Key differences from production:
#   - STRIPE_SECRET_KEY uses sk_test_... (Stripe test mode)
#   - POSTGRES_DB is roost_staging (separate DB from production)
#   - SENTRY_ENVIRONMENT is "staging"
#   - BASE_URL points to staging subdomain
#   - Emails have [STAGING] prefix to prevent confusion with real emails

# ── Environment ──────────────────────────────────────────────────────────────
NODE_ENV=staging
ROOST_ENV=staging
LOG_LEVEL=debug

# ── Base URLs ────────────────────────────────────────────────────────────────
BASE_URL=https://staging.roost.yourflock.org
API_URL=https://api.staging.roost.yourflock.org

# ── Database ─────────────────────────────────────────────────────────────────
POSTGRES_HOST=localhost
POSTGRES_PORT=5434
POSTGRES_USER=roost_staging
POSTGRES_PASSWORD=REPLACE_WITH_STAGING_DB_PASSWORD
POSTGRES_DB=roost_staging
POSTGRES_URL=postgresql://roost_staging:REPLACE_WITH_STAGING_DB_PASSWORD@localhost:5434/roost_staging

# ── Redis ────────────────────────────────────────────────────────────────────
REDIS_URL=redis://localhost:6380

# ── Stripe (TEST MODE — uses test cards, no real charges) ────────────────────
# Get from: https://dashboard.stripe.com/test/apikeys
STRIPE_SECRET_KEY=sk_test_REPLACE_WITH_TEST_KEY
STRIPE_PUBLISHABLE_KEY=pk_test_REPLACE_WITH_TEST_KEY

# Get from: https://dashboard.stripe.com/test/webhooks
# Add staging endpoint: https://api.staging.roost.yourflock.org/billing/webhook
STRIPE_WEBHOOK_SECRET=whsec_REPLACE_WITH_STAGING_WEBHOOK_SECRET

# Stripe price IDs (test mode — create in Stripe test dashboard)
STRIPE_PRICE_MONTHLY=price_test_REPLACE_MONTHLY
STRIPE_PRICE_ANNUAL=price_test_REPLACE_ANNUAL

# ── Authentication ───────────────────────────────────────────────────────────
JWT_SECRET=REPLACE_WITH_STAGING_JWT_SECRET_MIN_32_CHARS
JWT_EXPIRY_HOURS=24

# ── Sentry Error Tracking ────────────────────────────────────────────────────
# Get from: https://sentry.io → yourflock → roost-backend → DSN
SENTRY_DSN=https://REPLACE@sentry.io/REPLACE
SENTRY_ENVIRONMENT=staging
SENTRY_RELEASE=

# ── Email (Elastic Email) ────────────────────────────────────────────────────
# Use same credentials as production — but with [STAGING] prefix in subjects.
ELASTIC_EMAIL_API_KEY=REPLACE_WITH_ELASTIC_EMAIL_KEY
FROM_EMAIL=staging@yourflock.org
FROM_NAME=[STAGING] Roost

# ── Object Storage (Cloudflare R2) ───────────────────────────────────────────
# Use separate staging R2 buckets (or the same bucket with staging/ prefix)
R2_ACCOUNT_ID=REPLACE_WITH_CF_ACCOUNT_ID
R2_ACCESS_KEY_ID=REPLACE_WITH_R2_ACCESS_KEY
R2_SECRET_ACCESS_KEY=REPLACE_WITH_R2_SECRET_KEY
R2_BUCKET_STREAMS=roost-streams-staging
R2_BUCKET_VOD=roost-vod-staging
R2_BUCKET_BACKUPS=roost-backups-staging
R2_ENDPOINT=https://REPLACE_WITH_CF_ACCOUNT_ID.r2.cloudflarestorage.com

# ── Service Ports ─────────────────────────────────────────────────────────────
BILLING_PORT=8085
INGEST_PORT=8094
RELAY_PORT=8090
CATALOG_PORT=8095
EPG_PORT=8096
OWL_API_PORT=8091

# ── Image Registry ────────────────────────────────────────────────────────────
IMAGE_TAG=develop

# ── Cloudflare (for CDN config, not required for basic staging) ──────────────
CLOUDFLARE_API_KEY=REPLACE_WITH_CF_API_KEY
CLOUDFLARE_ZONE_ID=REPLACE_WITH_ZONE_ID

# ── Admin Access ─────────────────────────────────────────────────────────────
ADMIN_SECRET=REPLACE_WITH_STAGING_ADMIN_SECRET
SUPEROWNER_EMAIL=alisalaah@gmail.com
